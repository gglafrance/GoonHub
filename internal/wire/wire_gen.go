// Code generated by Wire. DO NOT EDIT.

//go:generate go run -mod=mod github.com/google/wire/cmd/wire
//go:build !wireinject
// +build !wireinject

package wire

import (
	"goonhub/internal/api"
	"goonhub/internal/api/v1/handler"
	"goonhub/internal/config"
	"goonhub/internal/core"
	"goonhub/internal/data"
	"goonhub/internal/infrastructure/logging"
	"goonhub/internal/infrastructure/persistence/sqlite"
	"goonhub/internal/infrastructure/server"
	"gorm.io/gorm"
)

// Injectors from wire.go:

func InitializeServer(cfgPath string) (*server.Server, error) {
	configConfig, err := config.Load(cfgPath)
	if err != nil {
		return nil, err
	}
	logger, err := logging.New(configConfig)
	if err != nil {
		return nil, err
	}
	db, err := sqlite.NewDB(configConfig, logger)
	if err != nil {
		return nil, err
	}
	videoRepository := provideVideoRepository(db)
	videoService := provideVideoService(videoRepository, configConfig)
	videoHandler := handler.NewVideoHandler(videoService)
	engine := api.NewRouter(logger, configConfig, videoHandler)
	serverServer := server.NewHTTPServer(engine, logger, configConfig)
	return serverServer, nil
}

// wire.go:

func provideVideoRepository(db *gorm.DB) data.VideoRepository {
	return data.NewSQLiteVideoRepository(db)
}

func provideVideoService(repo data.VideoRepository, cfg *config.Config) *core.VideoService {

	dataPath := "./data"

	return core.NewVideoService(repo, dataPath)
}
